version: "3.2"

services:

  vernemq:
    build: vernemq
    ports:
      - 1883:1883
    environment:
      DOCKER_VERNEMQ_ALLOW_ANONYMOUS: "on"

  dev:
    image: ruby:2.5
    depends_on:
      - vernemq
    volumes:
      - .:/work
      - gem-cache:/usr/local/bundle
    working_dir: /work
    command: /bin/bash
    environment:
      MQTT_HOST: vernemq

volumes:
  gem-cache: ~
